# Rust code generator from .msg and .srv of ROS2

This is used for [safe_drive](https://github.com/tier4/safe_drive), a Rust bindings of ROS2.

## Types (Galactic)

| ROS                          | C                                         | Rust                       |
|------------------------------|-------------------------------------------|----------------------------|
| bool                         | bool                                      | bool                       |
| byte                         | uint8_t                                   | u8                         |
| char                         | char                                      | i8                         |
| int8                         | int8_t                                    | i8                         |
| uint8                        | uint8_t                                   | u8                         |
| int16                        | int16_t                                   | i16                        |
| uint16                       | uint16_t                                  | u16                        |
| int32                        | int32_t                                   | i32                        |
| uint32                       | uint32_t                                  | u32                        |
| int64                        | int64_t                                   | i64                        |
| uint64                       | uint64_t                                  | u64                        |
| float32                      | float                                     | f32                        |
| float64                      | double                                    | f64                        |
| string                       | struct rosidl_runtime_c__String           | safe_drive::msg::RosString |
| builtin_interfaces/*         | struct builtin_interfaces__msg__*         | (*1)                       |

- (*1): Rust's types are automatically generated by C's header files
  - Defined in [safe_drive::msgs](https://github.com/tier4/safe_drive/blob/main/src/msgs.rs).

## Array Types

### `uint8` - `uint64` and `int8` - `int64`

| ROS              | C                                         | Rust                       |
|------------------|-------------------------------------------|----------------------------|
| int8[]           | struct rosidl_runtime_c__int8__Sequence   | safe_drive::msg::I8Seq<0>  |
| int8[<=5]        | struct rosidl_runtime_c__int8__Sequence   | safe_drive::msg::I8Seq<5>  |
| int8[10]         | int8_t var[10]                            | [i8; 10]                   |
| uint8[]          | struct rosidl_runtime_c__uint8__Sequence  | safe_drive::msg::U8Seq<0>  |
| uint8[<=5]       | struct rosidl_runtime_c__uint8__Sequence  | safe_drive::msg::U8Seq<5>  |
| uint8[10]        | uint8_t var[10]                           | [u8; 10]                   |

Other integer types are similar to this.

### Floating point types

| ROS              | C                                         | Rust                       |
|------------------|-------------------------------------------|----------------------------|
| float32[]        | struct rosidl_runtime_c__float__Sequence  | safe_drive::msg::F32Seq<0> |
| float32[<=5]     | struct rosidl_runtime_c__float__Sequence  | safe_drive::msg::F32Seq<5> |
| float32[10]      | float var[10]                             | [f32; 10]                  |
| float64[]        | struct rosidl_runtime_c__double__Sequence | safe_drive::msg::F64Seq<0> |
| float64[<=5]     | struct rosidl_runtime_c__double__Sequence | safe_drive::msg::F64Seq<5> |
| float64[10]      | double var[10]                            | [f64; 10]                  |

### Boolean type

| ROS              | C                                          | Rust                        |
|------------------|--------------------------------------------|-----------------------------|
| bool[]           | struct rosidl_runtime_c__boolean__Sequence | safe_drive::msg::BoolSeq<0> |
| bool[<=5]        | struct rosidl_runtime_c__boolean__Sequence | safe_drive::msg::BoolSeq<5> |
| bool[10]         | bool var[10]                               | [bool; 10]                  |

### String type

| ROS              | C                                          | Rust                                |
|------------------|--------------------------------------------|-------------------------------------|
| string[]         | struct rosidl_runtime_c__String__Sequence  | safe_drive::msg::StringSeq<0, 0>    |
| string[<=5]      | struct rosidl_runtime_c__String__Sequence  | safe_drive::msg::StringSeq<0, 5>    |
| string[10]       | struct rosidl_runtime_c__String var[10]    | [safe_drive::msg::RosString<0>; 10] |
| string<=5        | struct rosidl_runtime_c__String var        | safe_drive::msg::RosString<5>       |
| string<=5[<=10]  | struct rosidl_runtime_c__String var[10]    | safe_drive::msg::StringSeq<5, 10>   |
| string<=5[10]    | struct rosidl_runtime_c__String var[10]    | [safe_drive::msg::RosString<5>; 10] |

Other integer values are same as this.

### builtin_interfaces

| ROS                         | C                                                  | Rust                                             |
|-----------------------------|----------------------------------------------------|--------------------------------------------------|
| builtin_interfaces/Duration | struct builtin_interfaces__msg__Duration__Sequence | safe_drive::msg::builtin_interfaces::DurationSeq |
| builtin_interfaces/Time     | struct builtin_interfaces__msg__Time__Sequence     | safe_drive::msg::builtin_interfaces::TimeSeq     |


## Memo

[rosidl_runtime_c__String](https://docs.ros2.org/galactic/api/rosidl_runtime_c/structrosidl__runtime__c____String.html)

```c
struct rosidl_runtime_c__String {
    char *data;
    size_t size;
    size_t capacity;
}
```

[rosidl_runtime_c__int32__Sequence](https://docs.ros2.org/galactic/api/rosidl_runtime_c/primitives__sequence_8h_source.html)

```c
#define ROSIDL_RUNTIME_C__PRIMITIVE_SEQUENCE(STRUCT_NAME, TYPE_NAME) \
typedef struct rosidl_runtime_c__ ## STRUCT_NAME ## __Sequence \
{ \
    TYPE_NAME * data;  \
    size_t size;  \
    size_t capacity;  \
} rosidl_runtime_c__ ## STRUCT_NAME ## __Sequence;

// sequence types for all basic types
ROSIDL_RUNTIME_C__PRIMITIVE_SEQUENCE(float, float)
ROSIDL_RUNTIME_C__PRIMITIVE_SEQUENCE(double, double)
ROSIDL_RUNTIME_C__PRIMITIVE_SEQUENCE(long_double, long double)
ROSIDL_RUNTIME_C__PRIMITIVE_SEQUENCE(char, signed char)
ROSIDL_RUNTIME_C__PRIMITIVE_SEQUENCE(wchar, uint16_t)
ROSIDL_RUNTIME_C__PRIMITIVE_SEQUENCE(boolean, bool)
ROSIDL_RUNTIME_C__PRIMITIVE_SEQUENCE(octet, uint8_t)
ROSIDL_RUNTIME_C__PRIMITIVE_SEQUENCE(uint8, uint8_t)
ROSIDL_RUNTIME_C__PRIMITIVE_SEQUENCE(int8, int8_t)
ROSIDL_RUNTIME_C__PRIMITIVE_SEQUENCE(uint16, uint16_t)
ROSIDL_RUNTIME_C__PRIMITIVE_SEQUENCE(int16, int16_t)
ROSIDL_RUNTIME_C__PRIMITIVE_SEQUENCE(uint32, uint32_t)
ROSIDL_RUNTIME_C__PRIMITIVE_SEQUENCE(int32, int32_t)
ROSIDL_RUNTIME_C__PRIMITIVE_SEQUENCE(uint64, uint64_t)
ROSIDL_RUNTIME_C__PRIMITIVE_SEQUENCE(int64, int64_t)
```

`std_msgs/Bool`

```c
typedef struct std_msgs__msg__Bool
{
  bool data;
} std_msgs__msg__Bool;

// Struct for a sequence of std_msgs__msg__Bool.
typedef struct std_msgs__msg__Bool__Sequence
{
  std_msgs__msg__Bool * data;
  /// The number of valid items in data
  size_t size;
  /// The number of allocated items in data
  size_t capacity;
} std_msgs__msg__Bool__Sequence;
```

`std_msgs/ByteMultiArray`

```c
// Struct defined in msg/ByteMultiArray in the package std_msgs.
typedef struct std_msgs__msg__ByteMultiArray
{
  std_msgs__msg__MultiArrayLayout layout;
  rosidl_runtime_c__octet__Sequence data;
} std_msgs__msg__ByteMultiArray;

// Struct for a sequence of std_msgs__msg__ByteMultiArray.
typedef struct std_msgs__msg__ByteMultiArray__Sequence
{
  std_msgs__msg__ByteMultiArray * data;
  /// The number of valid items in data
  size_t size;
  /// The number of allocated items in data
  size_t capacity;
} std_msgs__msg__ByteMultiArray__Sequence;
```
